## Codebase Patterns
<!--
Reusable patterns discovered during implementation.
Add new patterns here as you learn them.
Read this section FIRST on each iteration.
-->
- Use pnpm, not npm
- Run `pnpm check && pnpm typecheck` after every change
- Content source: CONTENT_SOURCE=locale for local dev (reads from ~/projects/ocobo-posts/)
- i18n: remix-i18next with useTranslation('common') + t('page.section.key')
- Routes follow ($lang) prefix pattern: _main.($lang).<page>.tsx
- Panda CSS recipes in preset/recipes/, tokens in preset/tokens/
- Legacy recipes live in preset/recipes/_legacy/ — delete dir when migration complete
- New/prototype recipes go in preset/recipes/ (standard path)
- When a legacy recipe reaches 0 usage, delete from _legacy/
- Named exports only, kebab-case filenames, no barrel files
- Navbar uses ocobo.* token namespace (ocobo.yellow, ocobo.dark, etc.) to match prototype
- Desktop vs mobile CTA: contact.cta (short) vs contact.cta.mobile (long)
- WebKit browsers need explicit hstack() pattern, not just display: flex
- Font token for headings is 'display' (Bermia), not 'heading'

---

# Progress Log

Project: Website Migration — Plan A (Prep + P1)
Source: specs/prd-migration-plan-a.md
Branch: migration-plan-a
Created: 2026-02-01T12:00:00Z

## Initial Setup
- Created stories.json with 16 features
- High priority: 11 features (deps, design system, flags, i18n, layout, P1 pages)
- Medium priority: 5 features (existing page adaptations, final doc sync)
- Low priority: 0 features
- Ready for implementation

---

## Feature 1: Upgrade Panda CSS v0.37 → v1.8 and Ark UI to v5.30
- Upgraded @pandacss/dev, @pandacss/preset-base, @pandacss/preset-panda, @pandacss/types from ^0.37.2 → ^1.8.1
- Ark UI already at ^5.30.0, no change needed
- Removed unused @shadow-panda/preset devDependency
- Fixed: definePreset now requires `name` property (added 'ocobo-preset')
- Fixed: carousel pattern `display: 'auto'` → `display: 'block'` (stricter types in v1)
- Kept @shadow-panda/style-context (still used by NavigationMenu.tsx)
- pnpm check ✅ pnpm typecheck ✅ codegen ✅ tests ✅ (2 pre-existing failures unrelated)

---

## Feature 2: Port design system tokens from prototype
- Colours: updated light variants to match prototype (mint.light #EBFDF5, sky.light #F0F9FB, gray.light #F5F5F5)
- Shadows: added soft, soft-md, soft-lg, dark, card, ring, offset from prototype
- Animations: added 17 animation tokens + keyframes (float, fade, bounce, spin, marquee, entry)
- Typography: added sans/display font aliases, custom lineHeights per size, fixed 2xl fontSize (1.375rem)
- Radii: added 2xl (1rem), 3xl (1.5rem) from prototype
- Fonts now reference names directly (Bornia/Bermia) instead of CSS vars
- Removed unused --font-header/--font-body CSS vars from index.css
- pnpm check ✅ pnpm typecheck ✅ codegen ✅ tests 133/133 ✅

---

## Feature 3: Port design system recipes from prototype
- Added text recipe (display-xl/lg/md, subtitle, body, label + colour variants)
- Added badge recipe (yellow/mint/sky/coral/dark/gray, sm/md sizes, sm/full rounded)
- Added iconBox recipe (sm/md/lg sizes, solid/outline/ghost variants, colour compoundVariants)
- Updated section recipe (added bg variants: white/gray/dark/yellow/sky/mint/coral + padding sm/md/lg)
- Existing section() calls unaffected — defaults to bg:'white', padding:'lg' (same py:24 as before)
- Adapted prototype ocobo.* colour refs → flat token names (dark, yellow, mint, etc.)
- pnpm check ✅ pnpm typecheck ✅ codegen ✅ tests 133/133 ✅

---

## Feature 4: Create feature flag system for unreleased pages
- Created app/modules/feature-flags.ts with DISABLED_PAGES env var
- Added shouldHide to useMenuItems for nav filtering
- Feature-flagged pages: technology, studio, jobs, podcasts
- pnpm check ✅ pnpm typecheck ✅

---

## Feature 5: Set up localisation with structured keys in common.json
- Added nav.*, footer.* keys to locales/{fr,en}/common.json
- Added i18n namespace skeletons for offer, method, about pages
- pnpm check ✅ pnpm typecheck ✅

---

## Feature 6: Migrate Navbar from prototype (Ark UI Menu, responsive drawer, scroll behaviour)
- Replaced Radix NavigationMenu with Ark UI Menu (desktop) + Dialog (mobile)
- Created app/components/navbar/: navbar.tsx, mobile-menu.tsx, nav-dropdown-item.tsx, nav-item-with-dropdown.tsx, types.ts, use-navbar-scroll.ts
- Ported morphing scroll behaviour (transparent → rounded pill with blur, logo scales)
- Rich dropdown items with icon + label + description + colour variants
- Full-screen mobile menu with accordion-style sections
- Added ocobo.* namespace tokens to match prototype (ocobo.yellow, ocobo.dark, etc.)
- Renamed types to match prototype: label/path/color/dropdown (not title/url/variant/subItems)
- Separate CTA labels: contact.cta (desktop), contact.cta.mobile (mobile)
- Fixed WebKit/Orion browser compat with explicit hstack() pattern
- Fixed font token: fontFamily: 'display' not 'heading'
- Updated useMenuItems with correct dropdown colours (yellow/coral/coral/sky for resources)
- Deleted old files: Header.tsx, MainMenu.tsx, MainMobileMenu.tsx, MobileMenu.tsx, SubMenu.tsx, NavigationMenu.tsx, navigation-menu.ts slot recipe
- Learnings documented in docs/migration-notes.md
- pnpm check ✅ pnpm typecheck ✅

---

## Feature 7: Migrate Footer from prototype
- Replaced old Footer with prototype design (4-column grid, darker bg, border separator)
- Uses Lucide icons (Linkedin, Youtube) in circular buttons with hover effects
- Outline CTA button matching prototype style (border, uppercase, arrow icon)
- Yellow link hover colour matching prototype (_hover: { color: 'ocobo.yellow' })
- Reuses Logocobo SVG component with white colour
- Keeps production components: NewsletterForm (HubSpot), LanguageSwitcher
- Dynamic menu items from useMenuItems (company, method dropdowns)
- All strings localised via t() using footer.* keys
- pnpm check ✅ pnpm typecheck ✅

---
